import{B as G,u as J,r as a,j as e,ad as K,ae as Q,d as W,af as X,ag as Y}from"./index-BHLdGC3O.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=G("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),te=()=>{var R,z,D;const t=J(),$="http://localhost:7000",[l,g]=a.useState(null),[p,b]=a.useState(null),[h,y]=a.useState(!1),[re,k]=a.useState(null),[se,M]=a.useState(null),[x,N]=a.useState(""),[d,P]=a.useState(""),[f,j]=a.useState(""),[v,c]=a.useState(null),[E,n]=a.useState(""),[S,C]=a.useState(null),[u,U]=a.useState(""),[w,F]=a.useState(""),[_,m]=a.useState(null),[A,L]=a.useState(null);if(!t.isAuthenticated)return e.jsx(K,{to:"/login",replace:!0});const I=r=>r.length<8?"Password must be at least 8 characters long.":/[A-Z]/.test(r)?/[a-z]/.test(r)?/[0-9]/.test(r)?"":"Password must include at least one digit.":"Password must include at least one lowercase letter.":"Password must include at least one uppercase letter.",T=r=>{const s=r.target.value;P(s);const o=I(s);n(o)},H=async r=>{var o;r.preventDefault(),c(null),C(null);const s=I(d);if(s){n(s);return}else n("");if(!x||!d||!f){c("All password fields are required.");return}if(d!==f){c("New passwords do not match.");return}try{const i=await X({current_password:x,new_password:d});C(i.msg||"Password changed successfully!"),N(""),P(""),j(""),n("")}catch(i){const q=((o=i.message)==null?void 0:o.toLowerCase())||"";q.includes("password must")||q.includes("password should")?n(i.message):c(i.message||"Failed to change password.")}},O=async r=>{if(r.preventDefault(),m(null),L(null),!u||!w){m("Both email and password are required.");return}if(!/\S+@\S+\.\S+/.test(u)){m("Invalid email format.");return}try{const s=await Y({new_email:u,password:w});L(s.msg||"Email updated successfully!"),U(""),F("")}catch(s){m(s.message||"Failed to update email.")}},V=r=>{var o;const s=(o=r.target.files)==null?void 0:o[0];s?(g(s),b(URL.createObjectURL(s)),k(null),M(null)):(g(null),b(null))},Z=async()=>{if(!l){B();return}y(!0),k(null);const r=new FormData;r.append("profile_picture",l);try{const s=await Q(r);W(s.msg||"Profile picture updated successfully!"),t.user&&s.profile_picture_url&&t.updateUserProfilePictureUrl(s.profile_picture_url),g(null),b(null)}catch(s){B(s.message||"Failed to upload profile picture."),console.error("Profile picture upload error:",s)}finally{y(!1)}};return a.useEffect(()=>{var r;(r=t.user)!=null&&r.profile_picture_url},[(R=t.user)==null?void 0:R.profile_picture_url,p,l]),e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-8 text-gray-900 dark:text-white",children:"User Profile"}),e.jsxs("div",{className:"mb-8 p-6 bg-white dark:bg-gray-800 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"Profile Picture"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsx("div",{className:"shrink-0",children:e.jsx("img",{className:"h-24 w-24 object-cover rounded-full",src:p||((z=t.user)!=null&&z.profile_picture_url?`${$}${t.user.profile_picture_url}`:`https://ui-avatars.com/api/?name=${encodeURIComponent(((D=t.user)==null?void 0:D.username)||"User")}&background=random&size=128`),alt:"Profile"})}),e.jsxs("label",{htmlFor:"profile-picture-upload",className:"block",children:[e.jsx("span",{className:"sr-only",children:"Choose profile photo"}),e.jsx("input",{type:"file",id:"profile-picture-upload",accept:"image/png, image/jpeg, image/gif",onChange:V,className:`block w-full text-sm text-gray-500 dark:text-gray-400\r
                         file:mr-4 file:py-2 file:px-4\r
                         file:rounded-lg file:border-0\r
                         file:text-sm file:font-semibold\r
                         file:bg-indigo-50 dark:file:bg-indigo-800 file:text-indigo-600 dark:file:text-indigo-300\r
                         hover:file:bg-indigo-100 dark:hover:file:bg-indigo-700\r
                         disabled:opacity-50`,disabled:h})]})]}),l&&e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:Z,disabled:h||!l,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[h?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}):e.jsx(ee,{size:16,className:"mr-2"}),"Upload New Picture"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"Change Password"}),v&&e.jsx("p",{className:"text-red-600 dark:text-red-300 bg-red-100 dark:bg-red-900 border border-red-300 dark:border-red-700 p-3 rounded mb-4",children:v}),S&&e.jsx("p",{className:"text-green-600 dark:text-green-300 bg-green-100 dark:bg-green-900 border border-green-300 dark:border-green-700 p-3 rounded mb-4",children:S}),e.jsxs("form",{onSubmit:H,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",htmlFor:"currentPassword",children:"Current Password"}),e.jsx("input",{type:"password",id:"currentPassword",value:x,onChange:r=>N(r.target.value),className:"shadow appearance-none border dark:border-gray-600 rounded w-full py-2 px-3 text-gray-700 dark:text-gray-200 leading-tight focus:outline-none focus:shadow-outline bg-white dark:bg-gray-700"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",htmlFor:"newPassword",children:"New Password"}),e.jsx("input",{type:"password",id:"newPassword",value:d,onChange:T,className:"shadow appearance-none border dark:border-gray-600 rounded w-full py-2 px-3 text-gray-700 dark:text-gray-200 leading-tight focus:outline-none focus:shadow-outline bg-white dark:bg-gray-700"}),E&&e.jsx("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:E})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",htmlFor:"confirmNewPassword",children:"Confirm New Password"}),e.jsx("input",{type:"password",id:"confirmNewPassword",value:f,onChange:r=>j(r.target.value),className:"shadow appearance-none border dark:border-gray-600 rounded w-full py-2 px-3 text-gray-700 dark:text-gray-200 mb-3 leading-tight focus:outline-none focus:shadow-outline bg-white dark:bg-gray-700"})]}),e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"Change Password"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"Update Email"}),_&&e.jsx("p",{className:"text-red-600 dark:text-red-300 bg-red-100 dark:bg-red-900 border border-red-300 dark:border-red-700 p-3 rounded mb-4",children:_}),A&&e.jsx("p",{className:"text-green-600 dark:text-green-300 bg-green-100 dark:bg-green-900 border border-green-300 dark:border-green-700 p-3 rounded mb-4",children:A}),e.jsxs("form",{onSubmit:O,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",htmlFor:"newEmail",children:"New Email"}),e.jsx("input",{type:"email",id:"newEmail",value:u,onChange:r=>U(r.target.value),className:"shadow appearance-none border dark:border-gray-600 rounded w-full py-2 px-3 text-gray-700 dark:text-gray-200 leading-tight focus:outline-none focus:shadow-outline bg-white dark:bg-gray-700"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",htmlFor:"confirmPasswordForEmail",children:"Confirm Password"}),e.jsx("input",{type:"password",id:"confirmPasswordForEmail",value:w,onChange:r=>F(r.target.value),className:"shadow appearance-none border dark:border-gray-600 rounded w-full py-2 px-3 text-gray-700 dark:text-gray-200 mb-3 leading-tight focus:outline-none focus:shadow-outline bg-white dark:bg-gray-700"})]}),e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"Update Email"})]})]})]})]})};function B(t){throw new Error("Function not implemented.")}export{te as default};
