import{r as t,j as e,ad as Ns,s as ss,ae as Ss,a as Ps,u as Cs,af as Fs,a7 as _s,ag as Rs,h as qs,ah as Es,ai as As,aj as Ds,ak as Us,al as Ts,am as Ms,an as $s,ao as Is,ap as Bs,aq as Ls,ar as Gs,as as Qs,at as Os,au as Vs}from"./index-BdV55VRa.js";import{D as Ys,M as qe,a as Le}from"./Modal-Dg13GNiF.js";const Ge=l=>l.length<8?{strong:!1,message:"Password must be at least 8 characters long."}:/[A-Z]/.test(l)?/[a-z]/.test(l)?/[0-9]/.test(l)?/[!@#$%^&*(),.?":{}|<>]/.test(l)?{strong:!0,message:"Password is strong."}:{strong:!1,message:"Password must include at least one special character."}:{strong:!1,message:"Password must include at least one digit."}:{strong:!1,message:"Password must include at least one lowercase letter."}:{strong:!1,message:"Password must include at least one uppercase letter."},zs=({onUserCreated:l,onCancel:N})=>{const[L,ne]=t.useState(""),[E,de]=t.useState(""),[le,A]=t.useState(""),[_,H]=t.useState(""),[ie,fe]=t.useState("user"),[f,Ee]=t.useState([]),[pe,ye]=t.useState(!1),[S,J]=t.useState(""),[D,we]=t.useState(""),[R,U]=t.useState(""),[G,c]=t.useState(""),[q,P]=t.useState(""),[Q,ce]=t.useState(""),[T,ue]=t.useState(!1),[X,K]=t.useState(null),[u,C]=t.useState({}),[O,V]=t.useState("");t.useEffect(()=>{(async()=>{ye(!0);try{const i=await Ns();Ee(i),i.length>0&&(i.length>=1&&J(i[0].id.toString()),i.length>=2&&U(i[1].id.toString()),i.length>=3&&P(i[2].id.toString()))}catch{K("Failed to load security questions."),ss("Failed to load security questions. Please try again.")}finally{ye(!1)}})()},[]);const ee=n=>{const i=n.target.value;de(i);const p=Ge(i);V(p.message)},ke=()=>{const n={};L.trim()||(n.username="Username is required.");const i=Ge(E);i.strong||(n.password=i.message),E!==le&&(n.confirmPassword="Passwords do not match."),_.trim()&&!/\S+@\S+\.\S+/.test(_)&&(n.email="Email is invalid."),ie||(n.role="Role is required.");const p=S,m=R,F=q;return!p||!m||!F?n.securityQuestions="All three security questions must be selected.":(p===m||p===F||m===F)&&(n.securityQuestions="Security questions must be unique."),D.trim()||(n.answer1="Answer for question 1 is required."),G.trim()||(n.answer2="Answer for question 2 is required."),Q.trim()||(n.answer3="Answer for question 3 is required."),C(n),Object.keys(n).length===0},je=async n=>{var p,m;if(n.preventDefault(),K(null),!ke())return;ue(!0);const i={username:L,password:E,email:_.trim()||void 0,role:ie,security_answers:[{question_id:parseInt(S,10),answer:D},{question_id:parseInt(R,10),answer:G},{question_id:parseInt(q,10),answer:Q}]};try{await Ss(i),Ps(`User "${L}" created successfully!`),l(),ne(""),de(""),A(""),H(""),fe("user"),f.length>=1&&J(f[0].id.toString()),f.length>=2&&U(f[1].id.toString()),f.length>=3?P(f[2].id.toString()):f.length===2?P(""):f.length===1?(U(""),P("")):(J(""),U(""),P("")),we(""),c(""),ce(""),C({}),V("")}catch(F){const me=((m=(p=F.response)==null?void 0:p.data)==null?void 0:m.msg)||F.message||"Failed to create user.";K(me),ss(me)}finally{ue(!1)}},se=n=>{const i=[S,R,q].filter(Boolean);return f.filter(p=>{const m=p.id.toString();return n==="q1"?m===S||!i.includes(m)||m==="":n==="q2"?m===R||!i.includes(m)||m==="":n==="q3"?m===q||!i.includes(m)||m==="":!i.includes(m)})};return pe?e.jsx("div",{className:"text-center p-4",children:"Loading security questions..."}):e.jsxs("form",{onSubmit:je,className:"space-y-6 p-4 sm:p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Create New User"}),X&&e.jsx("div",{className:"p-3 mb-4 text-sm text-red-700 bg-red-100 rounded-lg dark:bg-red-200 dark:text-red-800",role:"alert",children:X}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Username"}),e.jsx("input",{type:"text",id:"username",value:L,onChange:n=>ne(n.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0}),u.username&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:u.username})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),e.jsx("input",{type:"password",id:"password",value:E,onChange:ee,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0}),O&&e.jsx("p",{className:`mt-1 text-xs ${Ge(E).strong?"text-green-500":"text-red-500"}`,children:O}),u.password&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:u.password})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Confirm Password"}),e.jsx("input",{type:"password",id:"confirmPassword",value:le,onChange:n=>A(n.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0}),u.confirmPassword&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:u.confirmPassword})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Email (Optional)"}),e.jsx("input",{type:"email",id:"email",value:_,onChange:n=>H(n.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white"}),u.email&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:u.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Role"}),e.jsxs("select",{id:"role",value:ie,onChange:n=>fe(n.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"super_admin",children:"Super Admin"})]}),u.role&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:u.role})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900 dark:text-white",children:"Security Questions"}),u.securityQuestions&&e.jsx("p",{className:"text-xs text-red-500",children:u.securityQuestions}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"question1",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Question 1"}),e.jsxs("select",{id:"question1",value:S,onChange:n=>J(n.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md dark:bg-gray-700 dark:text-white",disabled:f.length===0,children:[e.jsx("option",{value:"",children:"Select a question"}),se("q1").map(n=>e.jsx("option",{value:n.id.toString(),children:n.question_text},`q1-${n.id}`))]}),e.jsx("input",{type:"text",id:"answer1",value:D,onChange:n=>we(n.target.value),placeholder:"Answer for question 1",className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0}),u.answer1&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:u.answer1})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"question2",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Question 2"}),e.jsxs("select",{id:"question2",value:R,onChange:n=>U(n.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md dark:bg-gray-700 dark:text-white",disabled:f.length===0,children:[e.jsx("option",{value:"",children:"Select a question"}),se("q2").map(n=>e.jsx("option",{value:n.id.toString(),children:n.question_text},`q2-${n.id}`))]}),e.jsx("input",{type:"text",id:"answer2",value:G,onChange:n=>c(n.target.value),placeholder:"Answer for question 2",className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0}),u.answer2&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:u.answer2})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"question3",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Question 3"}),e.jsxs("select",{id:"question3",value:q,onChange:n=>P(n.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md dark:bg-gray-700 dark:text-white",disabled:f.length===0,children:[e.jsx("option",{value:"",children:"Select a question"}),se("q3").map(n=>e.jsx("option",{value:n.id.toString(),children:n.question_text},`q3-${n.id}`))]}),e.jsx("input",{type:"text",id:"answer3",value:Q,onChange:n=>ce(n.target.value),placeholder:"Answer for question 3",className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0}),u.answer3&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:u.answer3})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:N,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white dark:bg-gray-600 dark:text-gray-200 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:T||pe,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 border border-transparent rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:T?"Creating...":"Create User"})]})]})},Js=()=>{var He,Je,Xe,Ke;const l=Cs(),[N,L]=t.useState([]),[ne,E]=t.useState(!0),[de,le]=t.useState(null),[A,_]=t.useState(1),[H,ie]=t.useState(10),[fe,f]=t.useState(0),[Ee,pe]=t.useState(0),[ye,S]=t.useState(!1),J=()=>{S(!1),Z(),c({type:"success",message:"New user created successfully!"})},[D,we]=t.useState("username"),[R,U]=t.useState("asc"),[G,c]=t.useState(null),[q,P]=t.useState(null),[Q,ce]=t.useState("user"),[T,ue]=t.useState(""),[X,K]=t.useState(""),[u,C]=t.useState(null),[O,V]=t.useState(null),[ee,ke]=t.useState(!1),[je,se]=t.useState(!1),[n,i]=t.useState(null),[p,m]=t.useState(null),[F,me]=t.useState(!1),[Qe,Ae]=t.useState(null),[Oe,ve]=t.useState(null),[De,Ue]=t.useState(null),[rs,ts]=t.useState(Date.now()),[M,Ve]=t.useState(!1),[Ne,Se]=t.useState(!0),[Pe,Ce]=t.useState(null),[k,w]=t.useState(0),[Y,re]=t.useState(""),[ge,Te]=t.useState(""),[be,Me]=t.useState(""),[j,Fe]=t.useState(!1),[v,h]=t.useState(null),[$e,y]=t.useState(null),[$,Ye]=t.useState(null),[Ws,_e]=t.useState([]),[z,Ie]=t.useState([]),[ze,xe]=t.useState([]),[te,he]=t.useState(!1),[ae,W]=t.useState(null),[Re,I]=t.useState(null),[Be,We]=t.useState(""),Ze=(s,r,o,d)=>{xe(a=>{let g;const b=a.findIndex(x=>x.file_id===s&&x.file_type===r);if(b>-1)return a.map((B,oe)=>oe===b?(g={...B,[o]:d},g):B);{const x=z.find(B=>B.id===s&&B.type===r);if(x)return g={file_id:x.id,file_type:x.type,can_view:!0,can_download:!0},g[o]=d,[...a,g]}return a}),Re&&I(null),ae&&W(null)},as=async()=>{var r,o;if(!$){I({type:"error",message:"No user selected."});return}he(!0),W(null),I(null);const s=ze.map(d=>({...d,can_view:typeof d.can_view=="boolean"?d.can_view:!1,can_download:typeof d.can_download=="boolean"?d.can_download:!1}));try{const d=await $s($.id,s);I({type:"success",message:d.msg||"Permissions updated successfully!"});const a=d.permissions||[];_e(a);const g=z.map(b=>{const x=a.find(oe=>oe.file_id===b.id&&oe.file_type===b.type);return{file_id:b.id,file_type:b.type,can_view:x?!!x.can_view:!0,can_download:x?!!x.can_download:!0}});xe(g)}catch(d){console.error("Error saving permissions:",d);const a=((o=(r=d.response)==null?void 0:r.data)==null?void 0:o.msg)||d.message||"Failed to save permissions.";W(a),I({type:"error",message:a})}finally{he(!1)}},os=()=>{Ye(null),_e([]),Ie([]),xe([]),W(null),I(null),We("")},Z=t.useCallback(async()=>{var s;if(l.isAuthenticated&&((s=l.user)==null?void 0:s.role)==="super_admin"){E(!0),le(null);try{const r=await Fs(A,H,D,R);L(r.users),f(r.total_pages),pe(r.total_users),_(r.page),ie(r.per_page)}catch(r){L([]),le(r.message||"Failed to fetch users."),c({type:"error",message:r.message||"Failed to fetch users."})}finally{E(!1)}}},[l.isAuthenticated,(He=l.user)==null?void 0:He.role,A,H,D,R]);if(t.useEffect(()=>{Z()},[Z]),t.useEffect(()=>{(async()=>{var r,o,d;if(l.isAuthenticated&&((r=l.user)==null?void 0:r.role)==="super_admin"){Se(!0),Ce(null);try{const a=await Rs();Ve(a.maintenance_mode_enabled)}catch(a){console.error("Failed to fetch maintenance mode status:",a);const g=((d=(o=a.response)==null?void 0:o.data)==null?void 0:d.msg)||a.message||"Failed to fetch maintenance status.";Ce(g)}finally{Se(!1)}}})()},[l.isAuthenticated,(Je=l.user)==null?void 0:Je.role]),t.useEffect(()=>{$&&(async()=>{var r;if(!l.isAuthenticated||((r=l.user)==null?void 0:r.role)!=="super_admin"){W("User not authorized for this action."),he(!1);return}he(!0),W(null),I(null),_e([]),Ie([]),xe([]);try{const d=(await qs(void 0,1,100)).documents.map(b=>({id:b.id,name:b.doc_name,type:"document"}));Ie(d);const a=await Es($.id);_e(a);const g=d.map(b=>{const x=a.find(es=>es.file_id===b.id&&es.file_type===b.type),B=x?!!x.can_view:!0,oe=x?!!x.can_download:!0;return{file_id:b.id,file_type:b.type,can_view:B,can_download:oe}});xe(g)}catch(o){console.error("Error fetching data for permissions:",o);const d=o.message||"Failed to fetch data for permissions.";W(d),I({type:"error",message:d})}finally{he(!1)}})()},[$,l.isAuthenticated,(Xe=l.user)==null?void 0:Xe.role]),!l.isAuthenticated)return e.jsx(_s,{to:"/login",replace:!0});if(((Ke=l.user)==null?void 0:Ke.role)!=="super_admin")return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600",children:"Unauthorized"}),e.jsx("p",{children:"You do not have permission to view this page."})]});const ns=s=>{_(s)},ds=s=>{D===s?U(r=>r==="asc"?"desc":"asc"):(we(s),U("asc")),_(1)},ls=s=>{P(s.id),ce(s.role),c(null)},is=async s=>{if(!(!q||s!==q)){c(null);try{const o=await Ls(s,{new_role:Q});c({type:"success",message:`User ${o.username}'s role updated to ${o.role}.`}),Z()}catch(r){c({type:"error",message:r.message||"Failed to update role."})}finally{P(null)}}},cs=s=>s.length<8?"Password must be at least 8 characters long.":/[A-Z]/.test(s)?/[a-z]/.test(s)?/[0-9]/.test(s)?"":"Password must include at least one digit.":"Password must include at least one lowercase letter.":"Password must include at least one uppercase letter.",us=async s=>{var o,d;if(s.preventDefault(),C(null),V(null),!T||!X){C("Both password fields are required.");return}if(T!==X){C("New passwords do not match.");return}const r=cs(T);if(r){C(r);return}ke(!0);try{const g=await As({new_password:T});V(g.msg||"Global password updated successfully!"),ue(""),K("")}catch(a){C(((d=(o=a.response)==null?void 0:o.data)==null?void 0:d.msg)||a.message||"Failed to change global password.")}finally{ke(!1)}},ms=async(s,r)=>{if(window.confirm(`Are you sure you want to deactivate user ${r}?`)){c(null);try{await Gs(s),c({type:"success",message:`User ${r} deactivated.`}),Z()}catch(o){c({type:"error",message:o.message||`Failed to deactivate ${r}.`})}}},gs=async()=>{var d,a;Se(!0),Ce(null),c(null);const s=M?Ts:Ms,r=M?"Maintenance mode disabled.":"Maintenance mode enabled.",o=M?"Failed to disable maintenance mode.":"Failed to enable maintenance mode.";try{const g=await s();Ve(g.maintenance_mode_enabled),c({type:"success",message:r})}catch(g){const b=((a=(d=g.response)==null?void 0:d.data)==null?void 0:a.msg)||g.message||o;Ce(b),c({type:"error",message:b})}finally{Se(!1)}},bs=async(s,r)=>{if(window.confirm(`Are you sure you want to activate user ${r}?`)){c(null);try{await Qs(s),c({type:"success",message:`User ${r} activated.`}),Z()}catch(o){c({type:"error",message:o.message||`Failed to activate ${r}.`})}}},xs=async(s,r)=>{if(window.confirm(`Are you sure you want to PERMANENTLY DELETE user ${r}? This action cannot be undone.`)){c(null);try{await Os(s),c({type:"success",message:`User ${r} deleted.`}),N.length===1&&A>1?_(A-1):Z()}catch(o){c({type:"error",message:o.message||`Failed to delete ${r}.`})}}},hs=async(s,r)=>{if(window.confirm(`Are you sure you want to require user ${r} to reset their password on next login?`)){c(null);try{await Vs(s),c({type:"success",message:`User ${r} will be required to reset their password on next login.`})}catch(o){c({type:"error",message:o.message||`Failed to force password reset for ${r}.`})}}},fs=async()=>{var s,r;se(!0),i(null),m(null);try{const o=await Ds();i(o.message+(o.backup_path?` Path: ${o.backup_path}`:""))}catch(o){m(((r=(s=o.response)==null?void 0:s.data)==null?void 0:r.msg)||o.message||"Failed to create backup.")}finally{se(!1)}},ps=s=>{s.target.files&&s.target.files[0]?(Ue(s.target.files[0]),ve(null),Ae(null)):Ue(null)},ys=async()=>{var r,o;if(!De){ve("Please select a .db backup file to restore.");return}if(window.confirm("Are you sure you want to restore the database? This will overwrite the current data and cannot be undone. It is highly recommended to take a fresh backup before restoring.")){me(!0),Ae(null),ve(null);const d=new FormData;d.append("backup_file",De);try{const a=await Us(d);Ae(a.message),Ue(null),ts(Date.now())}catch(a){ve(((o=(r=a.response)==null?void 0:r.data)==null?void 0:o.msg)||a.message||"Failed to restore database.")}finally{me(!1)}}},ws=async s=>{var r,o;if(s.preventDefault(),Y.trim()===""){h("Reason cannot be empty.");return}Fe(!0),h(null),y(null);try{const d=await Is(Y);y({type:"success",message:d.message||"Database reset process initiated. Backup created."}),w(5),re(""),h(null)}catch(d){const a=((o=(r=d.response)==null?void 0:r.data)==null?void 0:o.msg)||d.message||"Failed to start database reset process.";h(a),y({type:"error",message:a})}finally{Fe(!1)}},ks=async s=>{var r,o;if(s.preventDefault(),ge.trim()===""||be.trim()===""){h("Password and confirmation text are required.");return}Fe(!0),h(null),y(null);try{const d=await Bs(ge,be);y({type:"success",message:d.message||"Database has been successfully reset."}),w(0),re(""),Te(""),Me(""),h(null)}catch(d){const a=((o=(r=d.response)==null?void 0:r.data)==null?void 0:o.msg)||d.message||"Failed to confirm database reset.";h(a),y({type:"error",message:a})}finally{Fe(!1)}},js=s=>{Me(s.target.value),v&&h(null)},vs=[{key:"username",header:"Username",sortable:!0},{key:"email",header:"Email",sortable:!0,render:s=>s.email||"N/A"},{key:"role",header:"Role",sortable:!0,render:s=>{var r,o,d;return q===s.id?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:Q,onChange:a=>ce(a.target.value),className:"block w-auto pl-3 pr-10 py-1.5 text-sm border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200",disabled:((r=l.user)==null?void 0:r.username)===s.username&&N.filter(a=>a.role==="super_admin").length<=1&&Q!=="super_admin",onClick:a=>a.stopPropagation(),children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"super_admin",children:"Super Admin"})]}),e.jsx("button",{onClick:a=>{a.stopPropagation(),is(s.id)},className:"px-3 py-1 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Save"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),P(null)},className:"px-3 py-1 border border-gray-300 dark:border-gray-500 text-xs font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 shadow-sm",children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:s.role}),((o=l.user)==null?void 0:o.username)!==s.username&&e.jsx("button",{onClick:a=>{a.stopPropagation(),ls(s)},className:"text-blue-600 hover:text-blue-700 text-xs font-medium",children:"Edit"}),((d=l.user)==null?void 0:d.username)===s.username&&s.role==="super_admin"&&N.filter(a=>a.role==="super_admin").length<=1&&e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 italic",children:"(Cannot change role - only Super Admin)"})]})}},{key:"is_active",header:"Status",sortable:!0,render:s=>e.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${s.is_active?"bg-green-100 text-green-800 dark:bg-green-700 dark:text-green-100":"bg-red-100 text-red-800 dark:bg-red-700 dark:text-red-100"}`,children:s.is_active?"Active":"Inactive"})},{key:"created_at",header:"Created At",sortable:!0,render:s=>s.created_at?new Date(s.created_at).toLocaleDateString():"N/A"},{key:"actions",header:"Actions",render:s=>{var r,o,d;return e.jsxs("div",{className:"flex items-center space-x-3 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[s.is_active?e.jsx("button",{onClick:a=>{a.stopPropagation(),ms(s.id,s.username)},className:"text-yellow-600 hover:text-yellow-700 disabled:text-gray-400 dark:disabled:text-gray-500 text-xs font-medium",disabled:((r=l.user)==null?void 0:r.username)===s.username&&N.filter(a=>a.role==="super_admin"&&a.is_active).length<=1,children:"Deactivate"}):e.jsx("button",{onClick:a=>{a.stopPropagation(),bs(s.id,s.username)},className:"text-green-600 hover:text-green-700 text-xs font-medium",children:"Activate"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),xs(s.id,s.username)},className:"text-red-600 hover:text-red-700 disabled:text-gray-400 dark:disabled:text-gray-500 text-xs font-medium",disabled:((o=l.user)==null?void 0:o.username)===s.username,children:"Delete"}),s.role!=="super_admin"&&((d=l.user)==null?void 0:d.username)!==s.username&&e.jsx("button",{onClick:a=>{a.stopPropagation(),hs(s.id,s.username)},className:"text-purple-600 hover:text-purple-700 text-xs font-medium",children:"Force Reset"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),Ye(s)},className:"text-teal-600 hover:text-teal-700 text-xs font-medium",children:"Permissions"})]})}}];return e.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8 space-y-10 md:space-y-12",children:[e.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-xl p-6 md:p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-gray-100",children:"User Management"}),e.jsx("button",{onClick:()=>S(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition ease-in-out duration-150",children:"Create User"})]}),G&&e.jsx("div",{className:`p-4 mb-6 rounded-lg text-sm ${G.type==="success"?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-200 border border-green-200 dark:border-green-700":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-200 border border-red-200 dark:border-red-700"}`,children:G.message}),de&&N.length===0&&!ne&&e.jsxs("div",{className:"text-red-500 bg-red-100 dark:bg-red-900 dark:text-red-200 p-4 rounded-lg mb-6 text-sm",children:["Error: ",de]}),e.jsx(Ys,{columns:vs,data:N,rowClassName:"group hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",isLoading:ne,currentPage:A,totalPages:fe,onPageChange:ns,itemsPerPage:H,totalItems:Ee,sortColumn:D,sortOrder:R,onSort:ds})]}),e.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-xl p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 text-gray-800 dark:text-gray-100",children:"Global Site Password"}),u&&e.jsx("div",{className:"p-3 mb-4 rounded-md bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700 text-sm",children:u}),O&&e.jsx("div",{className:"p-3 mb-4 rounded-md bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 border border-green-200 dark:border-green-700 text-sm",children:O}),e.jsxs("form",{onSubmit:us,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newGlobalPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"New Global Password"}),e.jsx("input",{id:"newGlobalPassword",type:"password",value:T,onChange:s=>{ue(s.target.value),u&&C(null),O&&V(null)},className:"block w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500",required:!0,disabled:ee})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmNewGlobalPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Confirm New Global Password"}),e.jsx("input",{id:"confirmNewGlobalPassword",type:"password",value:X,onChange:s=>{K(s.target.value),u&&C(null),O&&V(null)},className:"block w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500",required:!0,disabled:ee})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",disabled:ee,className:"w-full flex justify-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-60 transition-colors",children:ee?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Change Global Password"})})]})]}),e.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-xl p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 text-gray-800 dark:text-gray-100",children:"Database Backup"}),p&&e.jsx("div",{className:"p-3 mb-4 rounded-md bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700 text-sm",children:p}),n&&e.jsx("div",{className:"p-3 mb-4 rounded-md bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 border border-green-200 dark:border-green-700 text-sm",children:n}),e.jsx("button",{onClick:fs,disabled:je,className:"w-full flex justify-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-60 transition-colors",children:je?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Create Backup"})]}),e.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-xl p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 text-gray-800 dark:text-gray-100",children:"Database Restore"}),Oe&&e.jsx("div",{className:"p-3 mb-4 rounded-md bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700 text-sm",children:Oe}),Qe&&e.jsx("div",{className:"p-3 mb-4 rounded-md bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 border border-green-200 dark:border-green-700 text-sm",children:Qe}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"restoreFile",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Select .db Backup File"}),e.jsx("input",{id:"restoreFile",type:"file",accept:".db",onChange:ps,className:"block w-full text-sm text-gray-700 dark:text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 dark:file:bg-gray-600 file:text-blue-700 dark:file:text-gray-200 hover:file:bg-blue-100 dark:hover:file:bg-gray-500 border border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 bg-white dark:bg-gray-700",disabled:F},rs)]}),e.jsx("button",{onClick:ys,disabled:F||!De,className:"w-full flex justify-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 transition-colors",children:F?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Restore from Backup"})]})]}),e.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-xl p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 text-gray-800 dark:text-gray-100",children:"Reset Database"}),$e&&e.jsx("div",{className:`p-3 mb-4 rounded-md text-sm ${$e.type==="success"?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 border border-green-200 dark:border-green-700":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700"}`,children:$e.message}),e.jsx("button",{onClick:()=>{y(null),h(null),w(1)},className:"w-full flex justify-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-60 transition-colors",disabled:j||k!==0,children:j?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Reset Database"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-3",children:"This action will permanently delete all data in the database. This process involves multiple confirmation steps."})]}),e.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-xl p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 text-gray-800 dark:text-gray-100",children:"System Maintenance Mode"}),Pe&&e.jsxs("div",{className:"p-3 mb-4 rounded-md bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700 text-sm",children:["Error: ",Pe]}),Ne&&!N.length&&!Pe&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading maintenance status..."}),(!Ne||N.length>0||Pe)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[e.jsx("label",{htmlFor:"maintenanceToggle",className:"flex items-center cursor-pointer",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",id:"maintenanceToggle",className:"sr-only",checked:M,onChange:gs,disabled:Ne}),e.jsx("div",{className:`block w-14 h-8 rounded-full transition-colors ${M?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}`}),e.jsx("div",{className:`dot absolute left-1 top-1 bg-white dark:bg-gray-300 w-6 h-6 rounded-full shadow-md transition-transform duration-300 ease-in-out ${M?"transform translate-x-6":""}`})]})}),e.jsxs("span",{className:`text-sm font-medium ${M?"text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300"}`,children:["Maintenance Mode is ",M?"ACTIVATED":"DEACTIVATED"]}),Ne&&e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-blue-500"})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2",children:"When activated, only Super Administrators can log in. Other users will be denied access."})]})]}),e.jsx(qe,{isOpen:$!==null,onClose:os,title:$?`File Permissions: ${$.username}`:"",children:e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search files...",value:Be,onChange:s=>We(s.target.value),className:"block w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500"})}),te&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"Loading permissions..."}),ae&&e.jsx("div",{className:"p-3 mb-4 rounded-md bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700 text-sm",children:ae}),Re&&e.jsx("div",{className:`p-3 mb-4 rounded-md text-sm ${Re.type==="success"?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 border border-green-200 dark:border-green-700":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700"}`,children:Re.message}),!te&&!ae&&z.length>0&&e.jsxs("form",{onSubmit:s=>{s.preventDefault(),as()},className:"space-y-4",children:[e.jsx("div",{className:"max-h-96 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg p-1 bg-gray-50 dark:bg-gray-800/50",children:z.filter(s=>s.name.toLowerCase().includes(Be.toLowerCase())).map(s=>{const r=ze.find(o=>o.file_id===s.id&&o.file_type===s.type);return e.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-600 last:border-b-0 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors duration-150 bg-white dark:bg-gray-700 shadow-sm my-1",children:[e.jsxs("h4",{className:"font-medium text-gray-800 dark:text-gray-100 truncate",title:s.name,children:[s.name," ",e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",s.type.replace("_"," "),")"]})]}),e.jsxs("div",{className:"flex items-center space-x-6 mt-2.5",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("input",{type:"checkbox",className:"rounded text-blue-600 focus:ring-blue-500 h-4 w-4 border-gray-300 dark:border-gray-500 bg-gray-100 dark:bg-gray-600 checked:bg-blue-600 dark:checked:bg-blue-500",checked:(r==null?void 0:r.can_view)??!0,onChange:o=>Ze(s.id,s.type,"can_view",o.target.checked)}),e.jsx("span",{children:"View"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("input",{type:"checkbox",className:"rounded text-blue-600 focus:ring-blue-500 h-4 w-4 border-gray-300 dark:border-gray-500 bg-gray-100 dark:bg-gray-600 checked:bg-blue-600 dark:checked:bg-blue-500",checked:(r==null?void 0:r.can_download)??!0,onChange:o=>Ze(s.id,s.type,"can_download",o.target.checked)}),e.jsx("span",{children:"Download"})]})]})]},`${s.type}-${s.id}`)})}),e.jsx("div",{className:"flex justify-end pt-3",children:e.jsx("button",{type:"submit",disabled:te,className:"px-6 py-2.5 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-blue-500 disabled:opacity-50",children:te?"Saving...":"Save Permissions"})})]}),!te&&!ae&&z.filter(s=>s.name.toLowerCase().includes(Be.toLowerCase())).length===0&&z.length>0&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"No files match your search term."}),!te&&!ae&&z.length===0&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"No documents found to set permissions for. Ensure documents are uploaded."})]})}),e.jsx(qe,{isOpen:ye,onClose:()=>S(!1),title:"Create New User",children:e.jsx(zs,{onUserCreated:J,onCancel:()=>S(!1)})}),k===1&&e.jsx(Le,{isOpen:k===1,title:"Confirm Database Reset - Step 1/3",message:e.jsx("span",{className:"text-red-700 dark:text-red-300 font-semibold",children:"This will delete EVERYTHING in the database. Are you sure you want to proceed?"}),onConfirm:()=>w(2),onCancel:()=>{w(0),y(null)},confirmButtonText:"Yes, I'm sure",cancelButtonText:"No, cancel",confirmButtonVariant:"danger"}),k===2&&e.jsx(Le,{isOpen:k===2,title:"Confirm Database Reset - Step 2/3",message:e.jsx("span",{className:"text-red-700 dark:text-red-300 font-semibold",children:"This action is IRREVERSIBLE. Once the database is reset, the data cannot be recovered. Are you absolutely sure?"}),onConfirm:()=>w(3),onCancel:()=>{w(0),y(null)},confirmButtonText:"Yes, I understand the risk",cancelButtonText:"No, cancel",confirmButtonVariant:"danger"}),k===3&&e.jsx(Le,{isOpen:k===3,title:"Confirm Database Reset - Step 3/3",message:e.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 font-semibold",children:"FINAL WARNING: Proceeding will open a form for you to state your reason before the reset. This is your last chance to cancel."}),onConfirm:()=>{w(4),h(null)},onCancel:()=>{w(0),y(null)},confirmButtonText:"Yes, proceed to reason form",cancelButtonText:"No, cancel",confirmButtonVariant:"warning"}),k===4&&e.jsx(qe,{isOpen:k===4,onClose:()=>{w(0),re(""),h(null),y(null)},title:"Reason for Database Reset",showCloseButton:!1,children:e.jsxs("form",{onSubmit:ws,className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"For security and auditing purposes, please provide a reason for resetting the database. This reason will be logged. Your action will be recorded along with this reason. This is a critical operation."}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"resetReason",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Reason for Reset ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"resetReason",value:Y,onChange:s=>{re(s.target.value),v&&s.target.value.trim()!==""&&h(null)},rows:4,className:`block w-full px-3 py-2 border ${v&&Y.trim()===""?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500`,required:!0,disabled:j,"aria-describedby":v&&Y.trim()===""?"resetReason-error":void 0}),v&&Y.trim()===""&&e.jsx("p",{id:"resetReason-error",className:"text-red-500 text-xs mt-1",children:v})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 pt-3 border-t border-gray-200 dark:border-gray-700 mt-5",children:[e.jsx("button",{type:"button",onClick:()=>{w(0),re(""),h(null),y({type:"error",message:"Database reset cancelled."})},disabled:j,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:bg-gray-600 dark:text-gray-200 dark:hover:bg-gray-500 dark:border-gray-500",children:"Cancel Reset Process"}),e.jsx("button",{type:"submit",disabled:j||!Y.trim(),className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:bg-red-300 dark:disabled:bg-red-400 transition-opacity",children:j?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Processing..."]}):"Submit and Reset Database"})]})]})}),k===5&&e.jsx(qe,{isOpen:k===5,onClose:()=>{},title:"Final Database Reset Confirmation",showCloseButton:!1,children:e.jsxs("form",{onSubmit:ks,className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"This is the final step. The database backup has been created. To proceed with the reset, please enter the confirmation password and text."}),v&&e.jsx("div",{className:"p-3 rounded-md bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700 text-sm",children:v}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"resetProcessPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Confirmation Password"}),e.jsx("input",{id:"resetProcessPassword",type:"password",value:ge,onChange:s=>{Te(s.target.value),v&&h(null)},className:`block w-full px-3 py-2 border ${!ge.trim()&&v?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500`,required:!0,disabled:j})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"resetProcessConfirmText",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:'Type "CONFIRM DELETE"'}),e.jsx("input",{id:"resetProcessConfirmText",type:"text",value:be,onChange:js,className:`block w-full px-3 py-2 border ${!be.trim()&&v?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500`,required:!0,disabled:j})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 pt-3 border-t border-gray-200 dark:border-gray-700 mt-5",children:[e.jsx("button",{type:"button",onClick:()=>{w(0),re(""),Te(""),Me(""),h(null),y({type:"error",message:"Database reset process cancelled by user at final confirmation."})},disabled:j,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:bg-gray-600 dark:text-gray-200 dark:hover:bg-gray-500 dark:border-gray-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:j||!ge.trim()||!be.trim(),className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-red-700 hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:bg-red-400 dark:disabled:bg-red-500 transition-opacity",children:j?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Resetting..."]}):"Confirm and Reset Database Now"})]})]})})]})};export{Js as default};
