import{u as er,r as n,aj as rr,j as r,ad as sr,ak as tr,i as ar,al as nr,am as or,an as dr,ao as lr,ap as ir,aq as cr,ar as ur,as as gr,at as mr,au as br,av as xr,aw as pr}from"./index-CZ-6_XbN.js";import{D as hr,M as yr}from"./Modal-BWOI6av5.js";const vr=()=>{var Ne,Pe,Se,_e;const d=er(),[g,ee]=n.useState([]),[re,se]=n.useState(!0),[te,ae]=n.useState(null),[N,F]=n.useState(1),[I,Ce]=n.useState(10),[Ee,Ae]=n.useState(0),[Me,Ue]=n.useState(0),[C,De]=n.useState("username"),[q,ne]=n.useState("asc"),[O,l]=n.useState(null),[V,z]=n.useState(null),[Y,oe]=n.useState("user"),[P,de]=n.useState(""),[K,le]=n.useState(""),[E,h]=n.useState(null),[A,M]=n.useState(null),[U,ie]=n.useState(!1),[ce,ue]=n.useState(!1),[ge,me]=n.useState(null),[be,xe]=n.useState(null),[W,pe]=n.useState(!1),[he,Z]=n.useState(null),[ye,D]=n.useState(null),[H,J]=n.useState(null),[Re,$e]=n.useState(Date.now()),[m,fe]=n.useState(!1),[R,$]=n.useState(!0),[L,G]=n.useState(null),[b,we]=n.useState(null),[fr,T]=n.useState([]),[y,Q]=n.useState([]),[ke,S]=n.useState([]),[w,_]=n.useState(!1),[k,f]=n.useState(null),[B,x]=n.useState(null),[X,ve]=n.useState(""),je=(e,s,a,o)=>{S(t=>{let i;const c=t.findIndex(u=>u.file_id===e&&u.file_type===s);if(c>-1)return t.map((p,j)=>j===c?(i={...p,[a]:o},i):p);{const u=y.find(p=>p.id===e&&p.type===s);if(u)return i={file_id:u.id,file_type:u.type,can_view:!0,can_download:!0},i[a]=o,[...t,i]}return t}),B&&x(null),k&&f(null)},Le=async()=>{var s,a;if(!b){x({type:"error",message:"No user selected."});return}_(!0),f(null),x(null);const e=ke.map(o=>({...o,can_view:typeof o.can_view=="boolean"?o.can_view:!1,can_download:typeof o.can_download=="boolean"?o.can_download:!1}));try{const o=await ur(b.id,e);x({type:"success",message:o.msg||"Permissions updated successfully!"});const t=o.permissions||[];T(t);const i=y.map(c=>{const u=t.find(j=>j.file_id===c.id&&j.file_type===c.type);return{file_id:c.id,file_type:c.type,can_view:u?!!u.can_view:!0,can_download:u?!!u.can_download:!0}});S(i)}catch(o){console.error("Error saving permissions:",o);const t=((a=(s=o.response)==null?void 0:s.data)==null?void 0:a.msg)||o.message||"Failed to save permissions.";f(t),x({type:"error",message:t})}finally{_(!1)}},Ge=()=>{we(null),T([]),Q([]),S([]),f(null),x(null),ve("")},v=n.useCallback(async()=>{var e;if(d.isAuthenticated&&((e=d.user)==null?void 0:e.role)==="super_admin"){se(!0),ae(null);try{const s=await rr(N,I,C,q);ee(s.users),Ae(s.total_pages),Ue(s.total_users),F(s.page),Ce(s.per_page)}catch(s){ee([]),ae(s.message||"Failed to fetch users."),l({type:"error",message:s.message||"Failed to fetch users."})}finally{se(!1)}}},[d.isAuthenticated,(Ne=d.user)==null?void 0:Ne.role,N,I,C,q]);if(n.useEffect(()=>{v()},[v]),n.useEffect(()=>{(async()=>{var s,a,o;if(d.isAuthenticated&&((s=d.user)==null?void 0:s.role)==="super_admin"){$(!0),G(null);try{const t=await tr();fe(t.maintenance_mode_enabled)}catch(t){console.error("Failed to fetch maintenance mode status:",t);const i=((o=(a=t.response)==null?void 0:a.data)==null?void 0:o.msg)||t.message||"Failed to fetch maintenance status.";G(i)}finally{$(!1)}}})()},[d.isAuthenticated,(Pe=d.user)==null?void 0:Pe.role]),n.useEffect(()=>{b&&(async()=>{var s;if(!d.isAuthenticated||((s=d.user)==null?void 0:s.role)!=="super_admin"){f("User not authorized for this action."),_(!1);return}_(!0),f(null),x(null),T([]),Q([]),S([]);try{const o=(await ar(void 0,1,100)).documents.map(c=>({id:c.id,name:c.doc_name,type:"document"}));Q(o);const t=await nr(b.id);T(t);const i=o.map(c=>{const u=t.find(Fe=>Fe.file_id===c.id&&Fe.file_type===c.type),p=u?!!u.can_view:!0,j=u?!!u.can_download:!0;return{file_id:c.id,file_type:c.type,can_view:p,can_download:j}});S(i)}catch(a){console.error("Error fetching data for permissions:",a);const o=a.message||"Failed to fetch data for permissions.";f(o),x({type:"error",message:o})}finally{_(!1)}})()},[b,d.isAuthenticated,(Se=d.user)==null?void 0:Se.role]),!d.isAuthenticated)return r.jsx(sr,{to:"/login",replace:!0});if(((_e=d.user)==null?void 0:_e.role)!=="super_admin")return r.jsxs("div",{className:"container mx-auto p-4",children:[r.jsx("h1",{className:"text-2xl font-bold text-red-600",children:"Unauthorized"}),r.jsx("p",{children:"You do not have permission to view this page."})]});const Te=e=>{F(e)},Be=e=>{C===e?ne(s=>s==="asc"?"desc":"asc"):(De(e),ne("asc")),F(1)},Ie=e=>{z(e.id),oe(e.role),l(null)},qe=async e=>{if(!(!V||e!==V)){l(null);try{const a=await gr(e,{new_role:Y});l({type:"success",message:`User ${a.username}'s role updated to ${a.role}.`}),v()}catch(s){l({type:"error",message:s.message||"Failed to update role."})}finally{z(null)}}},Oe=e=>e.length<8?"Password must be at least 8 characters long.":/[A-Z]/.test(e)?/[a-z]/.test(e)?/[0-9]/.test(e)?"":"Password must include at least one digit.":"Password must include at least one lowercase letter.":"Password must include at least one uppercase letter.",Ve=async e=>{var a,o;if(e.preventDefault(),h(null),M(null),!P||!K){h("Both password fields are required.");return}if(P!==K){h("New passwords do not match.");return}const s=Oe(P);if(s){h(s);return}ie(!0);try{const i=await or({new_password:P});M(i.msg||"Global password updated successfully!"),de(""),le("")}catch(t){h(((o=(a=t.response)==null?void 0:a.data)==null?void 0:o.msg)||t.message||"Failed to change global password.")}finally{ie(!1)}},ze=async(e,s)=>{if(window.confirm(`Are you sure you want to deactivate user ${s}?`)){l(null);try{await mr(e),l({type:"success",message:`User ${s} deactivated.`}),v()}catch(a){l({type:"error",message:a.message||`Failed to deactivate ${s}.`})}}},Ye=async()=>{var o,t;$(!0),G(null),l(null);const e=m?ir:cr,s=m?"Maintenance mode disabled.":"Maintenance mode enabled.",a=m?"Failed to disable maintenance mode.":"Failed to enable maintenance mode.";try{const i=await e();fe(i.maintenance_mode_enabled),l({type:"success",message:s})}catch(i){const c=((t=(o=i.response)==null?void 0:o.data)==null?void 0:t.msg)||i.message||a;G(c),l({type:"error",message:c})}finally{$(!1)}},Ke=async(e,s)=>{if(window.confirm(`Are you sure you want to activate user ${s}?`)){l(null);try{await br(e),l({type:"success",message:`User ${s} activated.`}),v()}catch(a){l({type:"error",message:a.message||`Failed to activate ${s}.`})}}},We=async(e,s)=>{if(window.confirm(`Are you sure you want to PERMANENTLY DELETE user ${s}? This action cannot be undone.`)){l(null);try{await xr(e),l({type:"success",message:`User ${s} deleted.`}),g.length===1&&N>1?F(N-1):v()}catch(a){l({type:"error",message:a.message||`Failed to delete ${s}.`})}}},Ze=async(e,s)=>{if(window.confirm(`Are you sure you want to require user ${s} to reset their password on next login?`)){l(null);try{await pr(e),l({type:"success",message:`User ${s} will be required to reset their password on next login.`})}catch(a){l({type:"error",message:a.message||`Failed to force password reset for ${s}.`})}}},He=async()=>{var e,s;ue(!0),me(null),xe(null);try{const a=await dr();me(a.message+(a.backup_path?` Path: ${a.backup_path}`:""))}catch(a){xe(((s=(e=a.response)==null?void 0:e.data)==null?void 0:s.msg)||a.message||"Failed to create backup.")}finally{ue(!1)}},Je=e=>{e.target.files&&e.target.files[0]?(J(e.target.files[0]),D(null),Z(null)):J(null)},Qe=async()=>{var s,a;if(!H){D("Please select a .db backup file to restore.");return}if(window.confirm("Are you sure you want to restore the database? This will overwrite the current data and cannot be undone. It is highly recommended to take a fresh backup before restoring.")){pe(!0),Z(null),D(null);const o=new FormData;o.append("backup_file",H);try{const t=await lr(o);Z(t.message),J(null),$e(Date.now())}catch(t){D(((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.msg)||t.message||"Failed to restore database.")}finally{pe(!1)}}},Xe=[{key:"username",header:"Username",sortable:!0},{key:"email",header:"Email",sortable:!0,render:e=>e.email||"N/A"},{key:"role",header:"Role",sortable:!0,render:e=>{var s,a,o;return V===e.id?r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsxs("select",{value:Y,onChange:t=>oe(t.target.value),className:"block w-auto pl-3 pr-10 py-1.5 text-sm border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200",disabled:((s=d.user)==null?void 0:s.username)===e.username&&g.filter(t=>t.role==="super_admin").length<=1&&Y!=="super_admin",onClick:t=>t.stopPropagation(),children:[r.jsx("option",{value:"user",children:"User"}),r.jsx("option",{value:"admin",children:"Admin"}),r.jsx("option",{value:"super_admin",children:"Super Admin"})]}),r.jsx("button",{onClick:t=>{t.stopPropagation(),qe(e.id)},className:"px-3 py-1 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Save"}),r.jsx("button",{onClick:t=>{t.stopPropagation(),z(null)},className:"px-3 py-1 border border-gray-300 dark:border-gray-500 text-xs font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 shadow-sm",children:"Cancel"})]}):r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{children:e.role}),((a=d.user)==null?void 0:a.username)!==e.username&&r.jsx("button",{onClick:t=>{t.stopPropagation(),Ie(e)},className:"text-blue-600 hover:text-blue-700 text-xs font-medium",children:"Edit"}),((o=d.user)==null?void 0:o.username)===e.username&&e.role==="super_admin"&&g.filter(t=>t.role==="super_admin").length<=1&&r.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 italic",children:"(Cannot change role - only Super Admin)"})]})}},{key:"is_active",header:"Status",sortable:!0,render:e=>r.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${e.is_active?"bg-green-100 text-green-800 dark:bg-green-700 dark:text-green-100":"bg-red-100 text-red-800 dark:bg-red-700 dark:text-red-100"}`,children:e.is_active?"Active":"Inactive"})},{key:"created_at",header:"Created At",sortable:!0,render:e=>e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"},{key:"actions",header:"Actions",render:e=>{var s,a,o;return r.jsxs("div",{className:"flex items-center space-x-3 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[e.is_active?r.jsx("button",{onClick:t=>{t.stopPropagation(),ze(e.id,e.username)},className:"text-yellow-600 hover:text-yellow-700 disabled:text-gray-400 dark:disabled:text-gray-500 text-xs font-medium",disabled:((s=d.user)==null?void 0:s.username)===e.username&&g.filter(t=>t.role==="super_admin"&&t.is_active).length<=1,children:"Deactivate"}):r.jsx("button",{onClick:t=>{t.stopPropagation(),Ke(e.id,e.username)},className:"text-green-600 hover:text-green-700 text-xs font-medium",children:"Activate"}),r.jsx("button",{onClick:t=>{t.stopPropagation(),We(e.id,e.username)},className:"text-red-600 hover:text-red-700 disabled:text-gray-400 dark:disabled:text-gray-500 text-xs font-medium",disabled:((a=d.user)==null?void 0:a.username)===e.username,children:"Delete"}),e.role!=="super_admin"&&((o=d.user)==null?void 0:o.username)!==e.username&&r.jsx("button",{onClick:t=>{t.stopPropagation(),Ze(e.id,e.username)},className:"text-purple-600 hover:text-purple-700 text-xs font-medium",children:"Force Reset"}),r.jsx("button",{onClick:t=>{t.stopPropagation(),we(e)},className:"text-teal-600 hover:text-teal-700 text-xs font-medium",children:"Permissions"})]})}}];return r.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8 space-y-10 md:space-y-12",children:[r.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-xl p-6 md:p-8",children:[r.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-6 text-gray-900 dark:text-gray-100",children:"User Management"}),O&&r.jsx("div",{className:`p-4 mb-6 rounded-lg text-sm ${O.type==="success"?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-200 border border-green-200 dark:border-green-700":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-200 border border-red-200 dark:border-red-700"}`,children:O.message}),te&&g.length===0&&!re&&r.jsxs("div",{className:"text-red-500 bg-red-100 dark:bg-red-900 dark:text-red-200 p-4 rounded-lg mb-6 text-sm",children:["Error: ",te]}),r.jsx(hr,{columns:Xe,data:g,rowClassName:"group hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",isLoading:re,currentPage:N,totalPages:Ee,onPageChange:Te,itemsPerPage:I,totalItems:Me,sortColumn:C,sortOrder:q,onSort:Be})]}),r.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-xl p-6 md:p-8",children:[r.jsx("h2",{className:"text-xl font-semibold mb-6 text-gray-800 dark:text-gray-100",children:"Global Site Password"}),E&&r.jsx("div",{className:"p-3 mb-4 rounded-md bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700 text-sm",children:E}),A&&r.jsx("div",{className:"p-3 mb-4 rounded-md bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 border border-green-200 dark:border-green-700 text-sm",children:A}),r.jsxs("form",{onSubmit:Ve,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"newGlobalPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"New Global Password"}),r.jsx("input",{id:"newGlobalPassword",type:"password",value:P,onChange:e=>{de(e.target.value),E&&h(null),A&&M(null)},className:"block w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500",required:!0,disabled:U})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"confirmNewGlobalPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Confirm New Global Password"}),r.jsx("input",{id:"confirmNewGlobalPassword",type:"password",value:K,onChange:e=>{le(e.target.value),E&&h(null),A&&M(null)},className:"block w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500",required:!0,disabled:U})]}),r.jsx("div",{className:"pt-2",children:r.jsx("button",{type:"submit",disabled:U,className:"w-full flex justify-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-60 transition-colors",children:U?r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Change Global Password"})})]})]}),r.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-xl p-6 md:p-8",children:[r.jsx("h2",{className:"text-xl font-semibold mb-6 text-gray-800 dark:text-gray-100",children:"Database Backup"}),be&&r.jsx("div",{className:"p-3 mb-4 rounded-md bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700 text-sm",children:be}),ge&&r.jsx("div",{className:"p-3 mb-4 rounded-md bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 border border-green-200 dark:border-green-700 text-sm",children:ge}),r.jsx("button",{onClick:He,disabled:ce,className:"w-full flex justify-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-60 transition-colors",children:ce?r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Create Backup"})]}),r.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-xl p-6 md:p-8",children:[r.jsx("h2",{className:"text-xl font-semibold mb-6 text-gray-800 dark:text-gray-100",children:"Database Restore"}),ye&&r.jsx("div",{className:"p-3 mb-4 rounded-md bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700 text-sm",children:ye}),he&&r.jsx("div",{className:"p-3 mb-4 rounded-md bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 border border-green-200 dark:border-green-700 text-sm",children:he}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"restoreFile",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Select .db Backup File"}),r.jsx("input",{id:"restoreFile",type:"file",accept:".db",onChange:Je,className:"block w-full text-sm text-gray-700 dark:text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 dark:file:bg-gray-600 file:text-blue-700 dark:file:text-gray-200 hover:file:bg-blue-100 dark:hover:file:bg-gray-500 border border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 bg-white dark:bg-gray-700",disabled:W},Re)]}),r.jsx("button",{onClick:Qe,disabled:W||!H,className:"w-full flex justify-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 transition-colors",children:W?r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Restore from Backup"})]})]}),r.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-xl p-6 md:p-8",children:[r.jsx("h2",{className:"text-xl font-semibold mb-6 text-gray-800 dark:text-gray-100",children:"System Maintenance Mode"}),L&&r.jsxs("div",{className:"p-3 mb-4 rounded-md bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700 text-sm",children:["Error: ",L]}),R&&!g.length&&!L&&r.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading maintenance status..."}),(!R||g.length>0||L)&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[r.jsx("label",{htmlFor:"maintenanceToggle",className:"flex items-center cursor-pointer",children:r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"checkbox",id:"maintenanceToggle",className:"sr-only",checked:m,onChange:Ye,disabled:R}),r.jsx("div",{className:`block w-14 h-8 rounded-full transition-colors ${m?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}`}),r.jsx("div",{className:`dot absolute left-1 top-1 bg-white dark:bg-gray-300 w-6 h-6 rounded-full shadow-md transition-transform duration-300 ease-in-out ${m?"transform translate-x-6":""}`})]})}),r.jsxs("span",{className:`text-sm font-medium ${m?"text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300"}`,children:["Maintenance Mode is ",m?"ACTIVATED":"DEACTIVATED"]}),R&&r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-blue-500"})]}),r.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2",children:"When activated, only Super Administrators can log in. Other users will be denied access."})]})]}),r.jsx(yr,{isOpen:b!==null,onClose:Ge,title:b?`File Permissions: ${b.username}`:"",children:r.jsxs("div",{className:"mt-4",children:[r.jsx("div",{className:"mb-4",children:r.jsx("input",{type:"text",placeholder:"Search files...",value:X,onChange:e=>ve(e.target.value),className:"block w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500"})}),w&&r.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"Loading permissions..."}),k&&r.jsx("div",{className:"p-3 mb-4 rounded-md bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700 text-sm",children:k}),B&&r.jsx("div",{className:`p-3 mb-4 rounded-md text-sm ${B.type==="success"?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 border border-green-200 dark:border-green-700":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 border border-red-200 dark:border-red-700"}`,children:B.message}),!w&&!k&&y.length>0&&r.jsxs("form",{onSubmit:e=>{e.preventDefault(),Le()},className:"space-y-4",children:[r.jsx("div",{className:"max-h-96 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg p-1 bg-gray-50 dark:bg-gray-800/50",children:y.filter(e=>e.name.toLowerCase().includes(X.toLowerCase())).map(e=>{const s=ke.find(a=>a.file_id===e.id&&a.file_type===e.type);return r.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-600 last:border-b-0 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors duration-150 bg-white dark:bg-gray-700 shadow-sm my-1",children:[r.jsxs("h4",{className:"font-medium text-gray-800 dark:text-gray-100 truncate",title:e.name,children:[e.name," ",r.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",e.type.replace("_"," "),")"]})]}),r.jsxs("div",{className:"flex items-center space-x-6 mt-2.5",children:[r.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer text-sm text-gray-700 dark:text-gray-300",children:[r.jsx("input",{type:"checkbox",className:"rounded text-blue-600 focus:ring-blue-500 h-4 w-4 border-gray-300 dark:border-gray-500 bg-gray-100 dark:bg-gray-600 checked:bg-blue-600 dark:checked:bg-blue-500",checked:(s==null?void 0:s.can_view)??!0,onChange:a=>je(e.id,e.type,"can_view",a.target.checked)}),r.jsx("span",{children:"View"})]}),r.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer text-sm text-gray-700 dark:text-gray-300",children:[r.jsx("input",{type:"checkbox",className:"rounded text-blue-600 focus:ring-blue-500 h-4 w-4 border-gray-300 dark:border-gray-500 bg-gray-100 dark:bg-gray-600 checked:bg-blue-600 dark:checked:bg-blue-500",checked:(s==null?void 0:s.can_download)??!0,onChange:a=>je(e.id,e.type,"can_download",a.target.checked)}),r.jsx("span",{children:"Download"})]})]})]},`${e.type}-${e.id}`)})}),r.jsx("div",{className:"flex justify-end pt-3",children:r.jsx("button",{type:"submit",disabled:w,className:"px-6 py-2.5 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-blue-500 disabled:opacity-50",children:w?"Saving...":"Save Permissions"})})]}),!w&&!k&&y.filter(e=>e.name.toLowerCase().includes(X.toLowerCase())).length===0&&y.length>0&&r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"No files match your search term."}),!w&&!k&&y.length===0&&r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"No documents found to set permissions for. Ensure documents are uploaded."})]})})]})};export{vr as default};
