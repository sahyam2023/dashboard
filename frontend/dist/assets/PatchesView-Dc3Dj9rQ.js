import{r as a,u as Qe,f as et,s as u,w as Re,j as e,L as vt,F as Je,X as kt,a as wt,x as St,b as C,y as _t,z as jt,g as Nt,h as Vt,i as It,A as Ft,D as Be,l as Pt,P as Ct,B as Dt,m as Ye,C as Ze,n as Mt,S as At,M as Lt,E as Ut,p as $t,q as Bt,t as Rt,v as zt}from"./index-Cw2BFgtR.js";import{u as Ot,d as Et,U as qt,o as Wt,c as Tt,e as Ht,a as U,b as Xt,T as Ge,M as Jt,F as Yt,C as Zt,P as Gt}from"./CommentSection-BhwPNxSP.js";import{C as Kt,D as Qt}from"./DataTable-BFDprOJK.js";import{F as es}from"./FilterTabs-DjY86yGV.js";import{E as ts}from"./ErrorState-DLVAG0CN.js";import{F as ss}from"./fuse-Ch1WBRTM.js";import{M as rs}from"./Modal-A6idVdaf.js";import{P as as}from"./plus-circle-KxjSPlMy.js";const Ke=()=>{const s=new Date,p=s.getFullYear(),g=String(s.getMonth()+1).padStart(2,"0"),D=String(s.getDate()).padStart(2,"0");return`${p}-${g}-${D}`},se="CREATE_NEW_VERSION_SENTINEL_VALUE",ls=Tt().shape({selectedSoftwareId:U().required("Software Product must be selected."),selectedVersionId:U().required("Version selection is required."),typedVersionString:U().when("selectedVersionId",{is:se,then:s=>s.required("New Version String is required when 'Enter New Version' is selected.").min(1),otherwise:s=>s.transform(p=>p===""?void 0:p).optional().nullable()}),patchName:U().required("Patch Name is required.").max(255,"Patch Name cannot exceed 255 characters."),releaseDate:U().transform(s=>s===""?void 0:s).optional().nullable(),inputMode:U().oneOf(["url","upload"]).required("Input mode must be selected."),externalUrl:U().when("inputMode",{is:"url",then:s=>s.required("External Download URL is required.").url("Please enter a valid URL."),otherwise:s=>s.optional().nullable()}),selectedFile:Xt().when(["inputMode","$isEditMode","$patchToEditIsExternal"],{is:(s,p,g)=>s!=="upload"?!1:!!(!p||p&&g),then:s=>s.required("Please select a file to upload.").test("filePresent","File is required for upload.",p=>!!p),otherwise:s=>s.nullable()}),description:U().transform(s=>s===""?void 0:s).optional().max(2e3,"Description cannot exceed 2000 characters.").nullable(),patch_by_developer:U().transform(s=>s===""?void 0:s).optional().max(255,"Patch developer name cannot exceed 255 characters.").nullable(),compatibleVmsVersionIds:Ht().of(U().required()).optional()}),os=({patchToEdit:s,onPatchAdded:p,onPatchUpdated:g,onCancelEdit:D})=>{const d=!!s,{register:h,handleSubmit:fe,control:Z,formState:{errors:i},watch:V,setValue:k,reset:$}=Ot({resolver:Wt(ls),context:{isEditMode:d,patchToEditIsExternal:(s==null?void 0:s.is_external_link)||!1},defaultValues:{selectedSoftwareId:"",selectedVersionId:"",typedVersionString:"",patchName:"",releaseDate:Ke(),description:"",inputMode:"url",externalUrl:"",selectedFile:null,patch_by_developer:"",compatibleVmsVersionIds:[]}}),[N,G]=a.useState([]),[B,R]=a.useState([]),[re,z]=a.useState([]),[ae,O]=a.useState(!1),[le,M]=a.useState(null),[b,K]=a.useState(!1),[Q,T]=a.useState(!1),[ke,we]=a.useState(!1),[oe,Se]=a.useState(0),[ee,F]=a.useState(!1),E=a.useRef(null),{isAuthenticated:q,user:he}=Qe(),A=he==null?void 0:he.role,w=V("selectedSoftwareId"),xe=V("selectedVersionId"),ne=V("inputMode"),P=V("selectedFile"),H=xe===se;a.useEffect(()=>{const r=c=>{ee&&(c.preventDefault(),c.returnValue="")};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}},[ee]),a.useEffect(()=>{const r=()=>{document.visibilityState==="hidden"&&ee&&wt("Changing tabs or minimizing the window might interrupt the upload process.")};return document.addEventListener("visibilitychange",r),()=>{document.removeEventListener("visibilitychange",r)}},[ee]),a.useEffect(()=>{q&&(A==="admin"||A==="super_admin")&&(T(!0),et().then(G).catch(()=>u("Failed to load software list.")).finally(()=>T(!1)))},[q,A]),a.useEffect(()=>{if(w&&N.length>0){T(!0),R([]),k("selectedVersionId",""),k("typedVersionString","");const r=N.find(c=>c.id.toString()===w);if(r&&(r.name==="VMS"||r.name==="VA")){O(!0);const c=N.find(f=>f.name==="VMS");c?(we(!0),Re(c.id).then(z).catch(()=>u("Failed to load VMS versions for compatibility.")).finally(()=>we(!1))):z([])}else O(!1),z([]);Re(parseInt(w)).then(R).catch(()=>u("Failed to load versions.")).finally(()=>T(!1))}else R([]),O(!1),z([]),k("selectedVersionId",""),k("typedVersionString","")},[w,k,N]),a.useEffect(()=>{if(d&&s&&N.length>0){const r=N.find(x=>x.id===s.software_id),c=!!r&&(r.name==="VMS"||r.name==="VA");O(c);const f={selectedSoftwareId:w&&w!==s.software_id.toString()?w:s.software_id.toString(),patchName:s.patch_name,releaseDate:s.release_date?s.release_date.split("T")[0]:"",description:s.description||"",inputMode:s.is_external_link?"url":"upload",externalUrl:s.is_external_link?s.download_link:"",patch_by_developer:s.patch_by_developer||"",compatibleVmsVersionIds:c&&s.compatible_vms_versions?typeof s.compatible_vms_versions=="string"?s.compatible_vms_versions.split(",").map(x=>x.trim()).filter(x=>x):Array.isArray(s.compatible_vms_versions)?s.compatible_vms_versions.map(String):[]:[]};w===s.software_id.toString()&&(s.version_id&&B.length>0?B.find(I=>I.id===s.version_id)?f.selectedVersionId=s.version_id.toString():(f.selectedVersionId=se,f.typedVersionString=s.version_number):s.version_number&&(f.selectedVersionId=se,f.typedVersionString=s.version_number)),$(f),s.is_external_link?M(null):M(s.original_filename_ref||s.download_link.split("/").pop()||"unknown_file"),k("selectedFile",null),E.current&&(E.current.value="")}else d||ie(!!w)},[d,s,B,w,$,k,N]);const ie=(r=!1)=>{const c=r?V("selectedSoftwareId"):"";$({selectedSoftwareId:c,selectedVersionId:"",typedVersionString:"",patchName:"",releaseDate:Ke(),description:"",inputMode:"url",externalUrl:"",selectedFile:null,patch_by_developer:"",compatibleVmsVersionIds:[]}),M(null),E.current&&(E.current.value="")},de=r=>{r.target.files&&r.target.files[0]?(k("selectedFile",r.target.files[0],{shouldValidate:!0,shouldDirty:!0}),M(null)):k("selectedFile",null,{shouldValidate:!0,shouldDirty:!0})},_e=()=>{k("selectedFile",null,{shouldValidate:!0,shouldDirty:!0}),E.current&&(E.current.value=""),d&&s&&!s.is_external_link&&M(s.original_filename_ref||s.download_link.split("/").pop()||"unknown_file")},je=async r=>{var I,te,ce,S,J,pe,be,Ne;K(!0),r.inputMode==="upload"&&r.selectedFile&&F(!0),Se(0);let c,f;r.selectedVersionId===se&&r.typedVersionString?f=r.typedVersionString.trim():r.selectedVersionId&&r.selectedVersionId!==se&&(c=parseInt(r.selectedVersionId));const x={software_id:parseInt(r.selectedSoftwareId),patch_name:r.patchName.trim(),description:((I=r.description)==null?void 0:I.trim())||void 0,release_date:r.releaseDate||void 0,patch_by_developer:((te=r.patch_by_developer)==null?void 0:te.trim())||void 0};c&&(x.version_id=c),f&&(x.typed_version_string=f),ae&&r.compatibleVmsVersionIds&&r.compatibleVmsVersionIds.length>0&&(x.compatible_vms_version_ids=r.compatibleVmsVersionIds);try{let y;if(r.inputMode==="url"){const _={...x,download_link:r.externalUrl.trim(),is_external_link:!0};d&&s?(y=await St(s.id,_),C(`Patch "${y.patch_name}" updated successfully!`),g&&g(y)):(y=await _t(_),C(`Patch "${y.patch_name}" added successfully!`),p&&p(y),d||(ie(!0),k("selectedVersionId",""),k("typedVersionString","")))}else{const _={software_id:parseInt(r.selectedSoftwareId),patch_name:r.patchName.trim(),description:((ce=r.description)==null?void 0:ce.trim())||void 0,release_date:r.releaseDate||void 0,patch_by_developer:((S=r.patch_by_developer)==null?void 0:S.trim())||void 0,version_id:c,typed_version_string:f,compatible_vms_version_ids:ae&&r.compatibleVmsVersionIds&&r.compatibleVmsVersionIds.length>0?r.compatibleVmsVersionIds:void 0};if(d&&s)if(!s.is_external_link||s.is_external_link&&r.selectedFile)y=await jt(s.id,_,r.selectedFile||null),C(`Patch "${y.patch_name}" updated successfully!`),g&&g(y);else{u("If switching from a URL to an uploaded file, please select a file."),K(!1),F(!1);return}else if(r.selectedFile){const W={software_id:r.selectedSoftwareId,...c&&{version_id:c.toString()},...f&&{typed_version_string:f},patch_name:r.patchName.trim(),...r.releaseDate&&{release_date:r.releaseDate},description:((J=r.description)==null?void 0:J.trim())||"",patch_by_developer:((pe=r.patch_by_developer)==null?void 0:pe.trim())||"",...ae&&r.compatibleVmsVersionIds&&r.compatibleVmsVersionIds.length>0&&{compatible_vms_version_ids_json:JSON.stringify(r.compatibleVmsVersionIds)}};y=await Nt(r.selectedFile,"patch",W,Ve=>Se(Ve)),C(`Patch "${y.patch_name}" added successfully via chunked upload!`),p&&p(y),ie(!0),k("selectedVersionId",""),k("typedVersionString","")}else{u("No file selected for upload. Please select a file."),K(!1),F(!1);return}}}catch(y){const _=((Ne=(be=y.response)==null?void 0:be.data)==null?void 0:Ne.msg)||y.message;let W=`Failed to ${d?"update":"add"} patch.`;_&&typeof _=="string"&&_.includes("UNIQUE constraint failed")?d?W="A patch with this name already exists for this software/version. Please use a different name or check for duplicates.":W="A patch with this name already exists for this software/version. Please use a different name.":_&&(W=_),u(W),r.inputMode==="upload"&&F(!1)}finally{K(!1),r.inputMode==="upload"&&F(!1)}},X=r=>{console.error("Form validation errors:",r),u("Please correct the errors highlighted in the form.")};return!q||!A||!["admin","super_admin"].includes(A)?null:e.jsxs("form",{onSubmit:fe(je,X),className:"space-y-6 bg-white dark:bg-gray-800 dark:border-gray-700 p-6 rounded-lg shadow-md border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100",children:d?"Edit Patch":"Add New Patch"}),d&&D&&e.jsx("button",{type:"button",onClick:D,className:"text-sm text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200",children:"Cancel"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"selectedSoftwareId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Software Product*"}),Q&&!N.length?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading software..."}):e.jsxs("select",{id:"selectedSoftwareId",...h("selectedSoftwareId"),disabled:b||Q&&!N.length,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md ${i.selectedSoftwareId?"border-red-500":""} dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600`,children:[e.jsx("option",{value:"",disabled:!0,children:"Select Software Product"}),N.map(r=>e.jsx("option",{value:r.id.toString(),children:r.name},r.id))]}),i.selectedSoftwareId&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:i.selectedSoftwareId.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"selectedVersionId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Version*"}),e.jsx("div",{className:"mt-1",children:e.jsxs("select",{id:"selectedVersionId",...h("selectedVersionId"),disabled:b||Q||!w,className:`block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md ${i.selectedVersionId?"border-red-500":""} dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600`,children:[e.jsx("option",{value:"",disabled:B.length>0&&!!w,children:Q&&w?"Loading versions...":"Select Existing Version"}),B.map(r=>e.jsx("option",{value:r.id.toString(),children:r.version_number},r.id)),e.jsx("option",{value:se,children:"Enter New Version String..."})]})}),H&&e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"typedVersionString",className:"block text-xs font-medium text-gray-600 dark:text-gray-400",children:"New Version String*:"}),e.jsx("input",{type:"text",id:"typedVersionString",...h("typedVersionString"),placeholder:"e.g., 2.5.1-hotfix",className:`mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md p-2 focus:ring-blue-500 focus:border-blue-500 ${i.typedVersionString?"border-red-500":""} dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600 dark:placeholder-gray-400`}),e.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"This version will be created for the selected software if it doesn't exist."})]}),i.selectedVersionId&&!H&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.selectedVersionId.message}),i.typedVersionString&&H&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.typedVersionString.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"patchName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Patch Name*"}),e.jsx("input",{type:"text",id:"patchName",...h("patchName"),disabled:b,className:`mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md p-2 focus:ring-blue-500 focus:border-blue-500 ${i.patchName?"border-red-500":""} dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600 dark:placeholder-gray-400`}),i.patchName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.patchName.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"releaseDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Release Date"}),e.jsx("input",{type:"date",id:"releaseDate",...h("releaseDate"),disabled:b,className:`mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md p-2 focus:ring-blue-500 focus:border-blue-500 ${i.releaseDate?"border-red-500":""} dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600`}),i.releaseDate&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.releaseDate.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"patch_by_developer",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Patch By Developer"}),e.jsx("input",{type:"text",id:"patch_by_developer",...h("patch_by_developer"),disabled:b,className:`mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md p-2 focus:ring-blue-500 focus:border-blue-500 ${i.patch_by_developer?"border-red-500":""} dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600 dark:placeholder-gray-400`}),i.patch_by_developer&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.patch_by_developer.message})]}),ae&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"compatibleVmsVersionIds",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Compatible VMS Versions (for VMS/VA Patches)"}),ke?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading VMS versions..."}):e.jsx(Et,{name:"compatibleVmsVersionIds",control:Z,defaultValue:[],render:({field:r})=>e.jsx("div",{className:"mt-1 block w-full max-h-40 overflow-y-auto p-2 border border-gray-300 rounded-md bg-white dark:bg-gray-700 dark:border-gray-600",children:re.length===0?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No VMS versions available."}):re.map(c=>{var f;return e.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:focus:ring-blue-600",value:c.id.toString(),checked:(f=r.value)==null?void 0:f.includes(c.id.toString()),onChange:x=>{const I=x.target.value,te=x.target.checked?[...r.value||[],I]:(r.value||[]).filter(ce=>ce!==I);r.onChange(te)},disabled:b||ke}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:c.version_number})]},c.id)})})}),i.compatibleVmsVersionIds&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.compatibleVmsVersionIds.message}),e.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Select VMS versions this patch is compatible with. Only applicable if the patch is for 'VMS' or 'VA' software."})]}),e.jsxs("div",{className:"my-4",children:[e.jsx("span",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Patch Source:"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"radio",...h("inputMode"),value:"url",className:"form-radio h-4 w-4 text-blue-600",disabled:b}),e.jsxs("span",{className:"flex items-center dark:text-gray-300",children:[e.jsx(vt,{size:16,className:"mr-1 text-gray-600 dark:text-gray-400"}),"Provide External Link"]})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"radio",...h("inputMode"),value:"upload",className:"form-radio h-4 w-4 text-blue-600",disabled:b}),e.jsxs("span",{className:"flex items-center dark:text-gray-300",children:[e.jsx(qt,{size:16,className:"mr-1 text-gray-600 dark:text-gray-400"}),"Upload File"]})]})]}),i.inputMode&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.inputMode.message})]}),ne==="url"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"externalUrl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"External Download URL*"}),e.jsx("input",{type:"url",id:"externalUrl",...h("externalUrl"),placeholder:"https://example.com/patch.exe",disabled:b,className:`mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md p-2 focus:ring-blue-500 focus:border-blue-500 ${i.externalUrl?"border-red-500":""} dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600 dark:placeholder-gray-400`}),i.externalUrl&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.externalUrl.message})]}),ne==="upload"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d&&le&&!P?"Replace File (Optional)":"Select File to Upload*"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md hover:border-blue-500 dark:border-gray-600 dark:hover:border-blue-400 transition-colors",children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx(Je,{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500"}),e.jsxs("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("label",{htmlFor:"patch-file-upload-input",className:"relative cursor-pointer bg-white dark:bg-gray-800 rounded-md font-medium text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[e.jsx("span",{children:P?"Change file":"Upload a file"}),e.jsx("input",{id:"patch-file-upload-input",name:"patch-file-input",type:"file",className:"sr-only",onChange:de,ref:E,disabled:b})]}),e.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"EXE, MSI, ZIP, etc."})]})}),(P||d&&le)&&e.jsxs("div",{className:"mt-3 flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-2 overflow-hidden",children:[e.jsx(Je,{size:18,className:"text-gray-500 dark:text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:P?P.name:le}),d&&le&&!P&&e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:"(current)"})]}),P&&e.jsx("button",{type:"button",onClick:_e,disabled:b,className:"p-1 rounded-full text-gray-400 hover:text-gray-600 hover:bg-gray-200 dark:text-gray-500 dark:hover:text-gray-300 dark:hover:bg-gray-600",children:e.jsx(kt,{size:16})})]}),i.selectedFile&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.selectedFile.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),e.jsx("textarea",{id:"description",rows:3,...h("description"),disabled:b,className:`mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md p-2 focus:ring-blue-500 focus:border-blue-500 ${i.description?"border-red-500":""} dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600 dark:placeholder-gray-400`}),i.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.description.message})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"submit",disabled:b||Q,className:"flex-1 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:b?d?"Updating...":"Adding...":d?"Update Patch":"Add Patch"}),d&&D&&e.jsx("button",{type:"button",onClick:D,disabled:b,className:"flex-1 inline-flex justify-center py-2 px-4 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 dark:border-gray-500 dark:text-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600",children:"Cancel"})]}),b&&ne==="upload"&&oe>0&&e.jsxs("div",{className:"w-full bg-gray-200 rounded-full h-4 dark:bg-gray-700 my-3 relative",children:[e.jsx("div",{className:"bg-blue-600 h-4 rounded-full transition-all duration-150 ease-out",style:{width:`${oe}%`}}),e.jsxs("p",{className:"absolute inset-0 text-center text-xs font-medium leading-4 text-white dark:text-gray-100",children:[Math.round(oe),"%"]})]})]})},hs=()=>{const{searchTerm:s,setSearchTerm:p}=Vt(),{isAuthenticated:g,user:D}=Qe(),d=D==null?void 0:D.role,[h,fe]=a.useState([]),[Z,i]=a.useState([]),[V,k]=a.useState(null),[$,N]=a.useState(""),[G,B]=a.useState(""),[R,re]=a.useState(""),[z,ae]=a.useState(""),[O,le]=a.useState(""),[M,b]=a.useState(""),[K,Q]=a.useState(1),[T,ke]=a.useState(15),[we,oe]=a.useState(0),[Se,ee]=a.useState(0),[F,E]=a.useState("patch_name"),[q,he]=a.useState("asc"),[A,w]=a.useState(!0),[xe,ne]=a.useState(null),[P,H]=a.useState(!1),[ie,de]=a.useState(null),[_e,je]=a.useState(!1),[X,r]=a.useState(null),[c,f]=a.useState(!1),[x,I]=a.useState(new Map),[te,ce]=a.useState(!1),[S,J]=a.useState(new Set),[pe,be]=a.useState(!1),[Ne,y]=a.useState(!1),[_,W]=a.useState(!1),[Ve,Ie]=a.useState(!1),[me,De]=a.useState(null),[Me,ze]=a.useState([]),[Fe,Pe]=a.useState(null),[Oe,Ae]=a.useState(!1),[Le,Ee]=a.useState(!1),[j,ye]=a.useState(null),Ce=a.useRef(null),qe=It(),Ue=a.useMemo(()=>V!==null||$!==""||G!==""||R!==""||s!=="",[V,$,G,R,s]),tt=a.useCallback(()=>{k(null),N(""),B(""),re(""),p&&p("")},[p]),st=()=>{L(1,!0)},rt=()=>{N(""),B(""),re("")},L=a.useCallback(async(t,o=!1)=>{var l,m;o&&w(!0),ne(null);try{const n=await Ft(V??void 0,t,T,F,q,z||void 0,O||void 0,M||void 0,s);fe(n.patches),oe(n.total_pages),ee(n.total_patches),Q(n.page),ke(n.per_page);const v=new Map;if(g&&n.patches)for(const ve of n.patches)v.set(ve.id,{favoriteId:ve.favorite_id});I(v)}catch(n){const v=((m=(l=n.response)==null?void 0:l.data)==null?void 0:m.msg)||n.message||"Failed to fetch patches.";o?(ne(v),fe([]),oe(0),ee(0)):u(v)}finally{o&&w(!1)}},[V,T,F,q,z,O,M,g,s]);a.useEffect(()=>{const t=setTimeout(()=>ae($),500);return()=>clearTimeout(t)},[$]),a.useEffect(()=>{const t=setTimeout(()=>le(G),500);return()=>clearTimeout(t)},[G]),a.useEffect(()=>{const t=setTimeout(()=>b(R),500);return()=>clearTimeout(t)},[R]),a.useEffect(()=>{g?L(1,!0):(fe([]),w(!1))},[g,V,F,q,z,O,M,s,L]),a.useEffect(()=>{const t=new URLSearchParams(qe.search),o=t.get("item_id"),l=t.get("comment_id");if(o&&l&&h.length>0){const m=parseInt(o,10);if(!isNaN(m)){const n=h.find(v=>v.id===m);n?((!j||j.id!==n.id)&&ye(n),setTimeout(()=>{var v;(v=Ce.current)==null||v.scrollIntoView({behavior:"smooth",block:"center"})},100)):console.warn(`PatchesView: Patch with item_id ${m} not found in the current list.`)}}},[qe.search,h,j]),a.useEffect(()=>{J(new Set)},[V,F,q,z,O,M,s,K]),a.useEffect(()=>{g&&et().then(i).catch(t=>u("Failed to load software list."))},[g]),a.useEffect(()=>{me?(Ee(!0),Re(me).then(ze).catch(()=>u("Failed to load versions for move target.")).finally(()=>Ee(!1))):ze([])},[me]);const at=t=>k(t),lt=t=>{E(t),he(o=>F===t&&o==="asc"?"desc":"asc")},ot=t=>L(t,!0),We=t=>{H(!1),de(null),L(1,!0)},nt=()=>{de(null),H(!0)},it=t=>{de(t),H(!0),window.scrollTo({top:0,behavior:"smooth"})},Te=()=>{de(null),H(!1)},dt=t=>{r(t),je(!0)},$e=()=>{r(null),je(!1)},ct=async()=>{if(X){f(!0),j&&j.id===X.id&&ye(null);try{await Ut(X.id),C(`Patch "${X.patch_name}" deleted.`),$e(),L(1,!0)}catch(t){u(t.message||"Delete failed."),$e()}finally{f(!1)}}},He=a.useMemo(()=>s?new ss(h,{keys:["patch_name","description","software_name","version_number","uploaded_by_username","updated_by_username"],includeScore:!0,threshold:.4}).search(s).map(o=>o.item):h,[h,s]),mt=(t,o)=>J(l=>{const m=new Set(l);return o?m.add(t):m.delete(t),m}),ut=t=>{const o=new Set;t&&He.forEach(l=>o.add(l.id)),J(o)},gt=()=>{if(S.size===0){u("No items selected.");return}Ae(!0)},ft=async()=>{Ae(!1),be(!0),j&&S.has(j.id)&&ye(null);try{const t=await $t(Array.from(S),"patch");C(t.msg||`${t.deleted_count} patch(es) deleted.`),J(new Set),L(1,!0)}catch(t){u(t.message||"Bulk delete failed.")}finally{be(!1)}},ht=async()=>{if(S.size===0){u("No items selected.");return}const t=h.filter(l=>S.has(l.id)&&!l.is_external_link&&l.is_downloadable!==!1);if(t.length===0){u("No downloadable patch files selected. External links or non-downloadable items cannot be bulk downloaded.");return}const o=t.map(l=>l.id);y(!0);try{const l=await Mt(o,"patch"),m=URL.createObjectURL(l),n=document.createElement("a");n.href=m;const v=new Date().toISOString().replace(/:/g,"-");n.download=`bulk_download_patches_${v}.zip`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(m),o.length===S.size?C("Download started for all selected downloadable patches."):C(`Starting download for ${o.length} patch file(s). External links or non-downloadable items were excluded.`)}catch(l){u(l.message||"Bulk download failed.")}finally{y(!1)}},xt=()=>{if(S.size===0){u("No items selected.");return}if(Z.length===0){u("Software list unavailable.");return}De(null),Pe(null),Ie(!0)},pt=async()=>{if(!Fe){u("Select target version.");return}Ie(!1),W(!0);try{const t=await Bt(Array.from(S),"patch",{target_version_id:Fe});C(t.msg||`${t.moved_count} patch(es) moved.`),J(new Set),L(1,!0)}catch(t){if(t.response&&t.response.data&&t.response.data.conflicted_items&&Array.isArray(t.response.data.conflicted_items)&&t.response.data.conflicted_items.length>0&&(t.response.status===400||t.response.status===207)){let o="Bulk move could not be completed for some patches due to naming conflicts. ";const l=t.response.data.conflicted_items,m=l.slice(0,3).map(n=>`"${n.name}" (ID ${n.id})`).join(", ");o+=`Conflicting items: ${m}`,l.length>3&&(o+=` and ${l.length-3} more.`),o+=" Please rename the patches or check the target version.",u(o),t.response.data.msg}else t.message&&typeof t.message=="string"&&t.message.includes("UNIQUE constraint failed")?u("A patch with this name already exists for the target software/version. Please check for duplicates."):t.message?u(t.message):u("Bulk move failed due to an unexpected error.")}finally{W(!1),De(null),Pe(null)}},bt=[{key:"patch_name",header:"Patch Name",sortable:!0},{key:"software_name",header:"Software",sortable:!0},{key:"version_number",header:"Version",sortable:!0},{key:"patch_by_developer",header:"Developer",sortable:!0,render:t=>t.patch_by_developer||"-"},{key:"compatible_vms_versions",header:"VMS Compatibility",sortable:!0,render:t=>{const o=t.software_name==="VMS"||t.software_name==="VA";let l="-";return o&&(t.compatible_vms_versions&&t.compatible_vms_versions.length>0?Array.isArray(t.compatible_vms_versions)?l=t.compatible_vms_versions.join(", "):typeof t.compatible_vms_versions=="string"?l=t.compatible_vms_versions:l="N/A":l="N/A"),e.jsx("div",{className:"text-center",children:l})}},{key:"description",header:"Description",render:t=>e.jsx("span",{className:"text-sm text-gray-600 block max-w-xs truncate",title:t.description||"",children:t.description||"-"})},{key:"release_date",header:"Release Date",sortable:!0,render:t=>Dt(t.release_date)},{key:"download_link",header:"Link",render:t=>{var l;const o=t.is_external_link||t.is_downloadable!==!1;return!o&&!t.is_external_link?e.jsxs("span",{className:"flex items-center text-gray-400 cursor-not-allowed",title:"Download not permitted",children:[e.jsx(Be,{size:14,className:"mr-1"}),"Link"]}):e.jsxs("a",{href:t.download_link,target:t.is_external_link||!((l=t.download_link)!=null&&l.startsWith("/"))?"_blank":"_self",rel:"noopener noreferrer",className:`flex items-center ${o?"text-blue-600 hover:text-blue-800":"text-gray-400 cursor-not-allowed"}`,onClick:m=>{o||m.preventDefault(),m.stopPropagation()},title:o?t.is_external_link?"Open external link":"Download patch":"Download not permitted",children:[e.jsx(Be,{size:14,className:"mr-1"}),"Link"]})}},{key:"uploaded_by_username",header:"Uploaded By",sortable:!0,render:t=>t.uploaded_by_username||"N/A"},{key:"updated_by_username",header:"Updated By",sortable:!1,render:t=>t.updated_by_username||"N/A"},{key:"created_at",header:"Created At",sortable:!0,render:t=>Ye(t.created_at??"")},{key:"updated_at",header:"Updated At",sortable:!0,render:t=>Ye(t.updated_at??"")},{key:"actions",header:"Actions",render:t=>{var o,l,m;return e.jsxs("div",{className:"flex space-x-1 items-center",children:[g&&e.jsx("button",{onClick:n=>{n.stopPropagation(),yt(t,"patch")},className:`p-1 rounded-md ${(o=x.get(t.id))!=null&&o.favoriteId?"text-yellow-500 hover:text-yellow-600":"text-gray-400 hover:text-yellow-500"}`,title:(l=x.get(t.id))!=null&&l.favoriteId?"Remove Favorite":"Add Favorite",children:e.jsx(At,{size:16,className:(m=x.get(t.id))!=null&&m.favoriteId?"fill-current":""})}),g&&e.jsxs("button",{onClick:n=>{n.stopPropagation(),j&&j.id===t.id?ye(null):(ye(t),setTimeout(()=>{var v;return(v=Ce.current)==null?void 0:v.scrollIntoView({behavior:"smooth"})},0))},className:"p-1 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 rounded-md",title:j&&j.id===t.id?"Hide Comments":"View Comments",children:[e.jsx(Lt,{size:16}),e.jsxs("span",{className:"ml-1 text-xs",children:["(",t.comment_count??0,")"]})]}),(d==="admin"||d==="super_admin")&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:n=>{n.stopPropagation(),it(t)},className:"p-1 text-blue-600 hover:text-blue-800 rounded-md",title:"Edit",children:e.jsx(Gt,{size:16})}),e.jsx("button",{onClick:n=>{n.stopPropagation(),dt(t)},className:"p-1 text-red-600 hover:text-red-800 rounded-md",title:"Delete",children:e.jsx(Ge,{size:16})})]})]})}}],Xe=a.useCallback(()=>{L(1,!0)},[L]),yt=async(t,o)=>{var v,ve;if(!g){u("Please log in to manage favorites.");return}const l=x.get(t.id),m=!!(l!=null&&l.favoriteId),n=new Map(x);m?n.set(t.id,{favoriteId:void 0}):n.set(t.id,{favoriteId:-1}),I(n);try{if(m&&typeof(l==null?void 0:l.favoriteId)=="number")await Rt(t.id,o),C(`"${t.patch_name}" removed from favorites.`),I(Y=>{const ue=new Map(Y);return ue.set(t.id,{favoriteId:void 0}),ue});else{const Y=await zt(t.id,o);I(ue=>{const ge=new Map(ue);return ge.set(t.id,{favoriteId:Y.id}),ge}),C(`"${t.patch_name}" added to favorites.`)}}catch(Y){u(((ve=(v=Y==null?void 0:Y.response)==null?void 0:v.data)==null?void 0:ve.msg)||Y.message||"Failed to update favorite."),I(ue=>{const ge=new Map(ue);return m?ge.set(t.id,{favoriteId:l==null?void 0:l.favoriteId}):ge.set(t.id,{favoriteId:void 0}),ge})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start sm:items-center mb-6 flex-col sm:flex-row",children:[e.jsxs("div",{children:[" ",e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Patches"})," ",e.jsx("p",{className:"text-gray-600 mt-1 dark:text-gray-300",children:"Browse and manage software patches."})," "]}),g&&(d==="admin"||d==="super_admin")&&!ie&&e.jsxs("button",{onClick:P?Te:nt,className:"mt-4 sm:mt-0 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(as,{size:18,className:"mr-2"})," ",P?"Cancel":"Add New Patch"]})]}),P&&e.jsxs("div",{className:"my-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg shadow",children:[" ",e.jsx(os,{patchToEdit:ie,onPatchAdded:()=>We(),onPatchUpdated:()=>We(),onCancelEdit:Te})," "]}),S.size>0&&e.jsx("div",{className:"my-4 p-3 bg-gray-100 dark:bg-gray-700 rounded-md shadow-sm border border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:[S.size," item(s) selected"]}),(d==="admin"||d==="super_admin")&&e.jsxs("button",{onClick:gt,disabled:pe,className:"px-3 py-1.5 text-xs font-medium rounded-md shadow-sm flex items-center focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 text-white bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500 disabled:opacity-50",children:[e.jsx(Ge,{size:14,className:"mr-1.5"}),"Delete"]}),g&&e.jsxs("button",{onClick:ht,disabled:Ne,className:"px-3 py-1.5 text-xs font-medium rounded-md shadow-sm flex items-center focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 text-white bg-green-500 hover:bg-green-600 dark:bg-green-600 dark:hover:bg-green-700 focus:ring-green-500 disabled:opacity-50",children:[e.jsx(Be,{size:14,className:"mr-1.5"}),"Download"]}),(d==="admin"||d==="super_admin")&&e.jsxs("button",{onClick:xt,disabled:_,className:"px-3 py-1.5 text-xs font-medium rounded-md shadow-sm flex items-center focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 text-white bg-blue-500 hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700 focus:ring-blue-500 disabled:opacity-50",children:[e.jsx(Jt,{size:14,className:"mr-1.5"}),"Move"]})]})}),Z.length>0&&e.jsx(es,{software:Z,selectedSoftwareId:V,onSelectFilter:at}),e.jsx("div",{className:"my-4",children:e.jsxs("button",{onClick:()=>ce(t=>!t),className:"flex items-center px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-md text-sm font-medium",children:[te?e.jsxs(e.Fragment,{children:[e.jsx(Kt,{size:18,className:"mr-2"}),"Hide"]}):e.jsxs(e.Fragment,{children:[e.jsx(Yt,{size:18,className:"mr-2"}),"Show"]})," Advanced Filters"]})}),te&&e.jsxs("div",{className:"my-4 p-4 border dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 space-y-4 md:space-y-0 md:flex md:flex-wrap md:items-end md:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"patchedByDevFilter",className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:"Developer"}),e.jsx("input",{id:"patchedByDevFilter",type:"text",value:R,onChange:t=>re(t.target.value),placeholder:"e.g., Main Dev",className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:"Released"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:$,onChange:t=>N(t.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-200"}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"to"}),e.jsx("input",{type:"date",value:G,onChange:t=>B(t.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-200"})]})]}),e.jsxs("div",{className:"flex items-end gap-2 pt-5",children:[e.jsx("button",{onClick:st,className:"text-sm px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Apply"}),e.jsx("button",{onClick:rt,className:"text-sm px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Clear"})]})]}),A?e.jsx("div",{className:"py-10",children:e.jsx(Pt,{message:"Loading patches..."})}):xe&&h.length===0&&!A?e.jsx(ts,{message:xe,onRetry:Xe}):!A&&!xe&&h.length===0?e.jsxs("div",{className:"text-center py-10 bg-white dark:bg-gray-800 rounded-lg shadow-sm my-6",children:[e.jsx(Ct,{size:48,className:"mx-auto text-yellow-500 dark:text-yellow-400 mb-4"}),e.jsx("p",{className:"text-xl font-semibold text-gray-700 dark:text-gray-200 mb-3",children:Ue?"No Patches Found Matching Criteria":"No Patches Available"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 px-4",children:Ue?"Try adjusting or clearing your search/filter settings.":d==="admin"||d==="super_admin"?"Add new patches to get started.":"Please check back later."}),Ue&&e.jsx("button",{onClick:tt,className:"mt-6 btn-primary text-sm",children:"Clear All Filters & Search"})]}):e.jsx(Qt,{columns:bt,data:He,rowClassName:"group",isLoading:A||c,currentPage:K,totalPages:we,onPageChange:ot,itemsPerPage:T,totalItems:Se,sortColumn:F,sortOrder:q,onSort:lt,isSelectionEnabled:!0,selectedItemIds:S,onSelectItem:mt,onSelectAllItems:ut}),_e&&X&&e.jsx(Ze,{isOpen:_e,title:"Delete Patch",message:`Delete "${X.patch_name}"?`,onConfirm:ct,onCancel:$e,isConfirming:c,confirmButtonText:"Delete",confirmButtonVariant:"danger"}),Oe&&e.jsx(Ze,{isOpen:Oe,title:`Delete ${S.size} Patch(es)`,message:`Delete ${S.size} selected items?`,onConfirm:ft,onCancel:()=>Ae(!1),isConfirming:pe,confirmButtonText:"Delete Selected",confirmButtonVariant:"danger"}),Ve&&e.jsx(rs,{isOpen:Ve,onClose:()=>Ie(!1),title:`Move ${S.size} Patch(es)`,children:e.jsxs("div",{className:"p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:"Select target Software and Version:"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"modalSoftwareMove",className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:"Target Software"}),e.jsxs("select",{id:"modalSoftwareMove",value:me??"",onChange:t=>{De(t.target.value?parseInt(t.target.value):null),Pe(null)},className:"input-class w-full dark:bg-gray-700 dark:text-white dark:border-gray-600",disabled:_||Z.length===0,children:[e.jsx("option",{value:"",children:"Select Software..."}),Z.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),me&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"modalVersionMove",className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:"Target Version"}),e.jsxs("select",{id:"modalVersionMove",value:Fe??"",onChange:t=>Pe(t.target.value?parseInt(t.target.value):null),className:"input-class w-full dark:bg-gray-700 dark:text-white dark:border-gray-600",disabled:_||Le||Me.length===0,children:[e.jsx("option",{value:"",children:Le?"Loading...":"Select Version..."}),Me.map(t=>e.jsx("option",{value:t.id,children:t.version_number},t.id))]}),Me.length===0&&!Le&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"No versions for selected software."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>Ie(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",disabled:_,children:"Cancel"}),e.jsx("button",{type:"button",onClick:pt,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:_||!me||!Fe,children:_?"Moving...":"Confirm Move"})]})]})}),g&&j&&e.jsxs("div",{ref:Ce,className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:["Comments for: ",e.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:j.patch_name})]}),e.jsx(Zt,{itemId:j.id,itemType:"patch",onCommentAction:Xe})]}),!g&&j&&e.jsx("div",{ref:Ce,className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700 text-center",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Please log in to view and manage comments."})})]})};export{hs as default};
